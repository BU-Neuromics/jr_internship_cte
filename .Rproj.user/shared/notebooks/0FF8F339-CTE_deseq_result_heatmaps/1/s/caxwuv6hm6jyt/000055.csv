"0","for (i in filtered_names) {"
"0","  palette_length <- 50"
"0","  colors <- colorRampPalette(c(""blue"", ""white"", ""red""))(palette_length)"
"0","  #initializing factor result dataframe"
"0","  scaled_05 <- heatmap_list[[i]]"
"0","  #divides each column's values by the max ABS of the column that value is under. "
"0","  for (x in seq_along(scaled_05)) {"
"0","    scaled_05[[x]] <- scaled_05[[x]] / max(abs(scaled_05[[x]]))"
"0","  }"
"0","  #Sets breaks to give a consistent -1 to 1 range and center zeros "
"0","  hm_breaks <- c(seq(min(scaled_05), 0, length.out=ceiling(palette_length/2) +1), "
"0","              seq(max(scaled_05)/palette_length, max(scaled_05), length.out=floor(palette_length/2)))"
"0","  pheatmap(scaled_05, cluster_rows = TRUE, cluster_cols = TRUE, color = colors, breaks = hm_breaks, main = paste(""Heatmap of significant (0.05) genes from "", i))"
"0","}"
