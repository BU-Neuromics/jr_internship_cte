"0","all_results_sig_01 <- lapply("
"0","  all_obj_names,"
"0","  function(result_name) {"
"0","    results_c <- results(all_deseq_obj[[result_name]])"
"0","    results_sig <- subset(results_c, padj < 0.01)"
"0","    results_sig <- results_sig[order(results_sig$pvalue), ]"
"0","    return(results_sig)"
"0","    })"
"0","names(all_results_sig_01) <- all_obj_names  "
"0",""
"0","heatmap_list_01 <- lapply("
"0","  all_obj_names,"
"0","  function(design_factor) {"
"0","    design_res <- all_results_sig_01[[design_factor]]"
"0","    design_df <- data.frame(design_res)"
"0","    design_genes <- data.frame(ENSGID = rownames(design_df), design_factor = design_df$log2FoldChange)"
"0","    merged_values <- merge(results_combined, design_genes, by=""ENSGID"")"
"0","    rownames(merged_values) <- merged_values[,""ENSGID""]"
"0","    merged_values <- subset(merged_values, select = -design_factor)"
"0","    merged_values <- subset(merged_values, select = -ENSGID)"
"0","  })"
"0","names(heatmap_list_01) <- all_obj_names "
"0",""
"0","#Removes dots in ENSGID IDs"
"0","for (i in all_obj_names) {"
"0","  rownames(heatmap_list_01[[i]]) <- gsub(""\\.\\d+$"", """", rownames(heatmap_list_01[[i]]))"
"0","}"
"0","#Converts ENSGIDs to gene symbols using map"
"0","for (i in seq_along(heatmap_list_01)) {"
"0","  heatmap_list_01[[i]]$rownames <- rownames(heatmap_list_01[[i]])"
"0","  heatmap_list_01[[i]] <- merge(heatmap_list_01[[i]], gene_map, by.x =""rownames"", by.y =""ensembl_gene_id"", all.x = TRUE)"
"0","  heatmap_list_01[[i]] <- heatmap_list_01[[i]][complete.cases(heatmap_list_01[[i]]$external_gene_name) & heatmap_list_01[[i]]$external_gene_name != """", ]"
"0","  rownames(heatmap_list_01[[i]]) <- make.unique(as.character(heatmap_list_01[[i]]$external_gene_name))"
"0","  heatmap_list_01[[i]] <- subset(heatmap_list_01[[i]], select = -c( rownames, external_gene_name))"
"0","}"
"0",""
"0","for (i in seq_along(heatmap_list_01)){"
"0","  heatmap_list_01 <- Filter(function(i) nrow(i) > 1, heatmap_list_01)"
"0","}"
"0","filtered_names <- names(heatmap_list_01)"
